\chapter{Analysis of selected models}
\label{cha:analysis_of_selected_models}
\glsresetall

\newpage
\begin{tcolorbox}[title={Contributions of this chapter}]
    The main contribution of this chapter is to apply the methods derived in \Cref{cha:state_space_models} to selected inference and prediction problems in the context of \gls{c19} in Germany. Each model is an extension of model we have used during the \gls{c19} pandemic to produce forecasts of cases, deaths and hospitalizations. As all content of this chapter is newly contributed, we give a short overview of the improvements that these models contribute.

    \paragraph{\nameref{sec:model_reporting_delay}}
    The model developed in this section is based on the \texttt{ILM-EKF} model that Thomas Hotz and the author have submitted to the ECDCs COVID-19 ForecastHub. The original model was also based on  an \gls{ssm}, however fit with an extended Kalman-filter and ignored the integer nature of the data. It also did not account for reporting delays and was based expressed in terms of reproduction numbers.

    \paragraph{\nameref{sec:regional_growth_factor_model}}
    This model is based on the \texttt{ITWW-county\_repro} model that Thomas Hotz, Tyll Krüger, Jan Pablo Burgard, Przemyslaw Biecek, Viktor Bezborodov, Marcin Bodych and the author have submitted to both the German-Polish COVID-19 ForecastHub and the ECDC's ForecastHub. This model was not formulated as  an \gls{ssm} and, in particular, ignored temporal dependencies. Moreover, it was based on reproduction numbers, which were fitted to the incidence data using small-area estimation methods. The main idea for this model is available in \citep{Heyder2022Regional}. The model developed in this chapter re‑casts these ideas in an \gls{ssm} framework based on growth factors, thereby explicitly modeling temporal dependence and avoiding the indirect use of reproduction numbers.

    \paragraph{\nameref{sec:nowcasting_hospitalizations}}
    The model designed in this section is based on the \texttt{ILM-prop} model that Thomas Hotz and the author submitted to the German NowcastHub. Again, this model was note based on an \gls{ssm}. It quantified the uncertainty by past forecast errors, which requires a substantial amount of computation - an aspect that the model presented in this section avoids by using a state-space formulation.
\end{tcolorbox}
\newpage
Having established the practical advantages of \gls{eis} over the \gls{cem} in the previous chapter, we now demonstrate the usefulness of \glspl{ssm} for epidemiological modeling. We present three applications: accounting for reporting artifacts (\Cref{sec:model_reporting_delay}), modeling regional effects (\Cref{sec:regional_growth_factor_model}), and performing fore- and nowcasting (\Cref{sec:nowcasting_hospitalizations}). These applications illustrate how \glspl{ssm} provide a flexible modeling framework that allows practitioners to tailor interpretable models to specific research questions.

The models we present in this chapter are not based on compartmental models, but rather on the epidemiological indicators presented in \Cref{sec:measures_of_epidemic_spread}. We prefer these methods, as the compartmental models require their users to make a lot of assumptions regarding the dynamics of the epidemics, e.g. whether reinfections can or cannot occur, whether population size is fixed or not and also distributional assumptions for the transition rates between compartments. 
Such assumptions are difficult to verify in practice, and the influence of deviation from them is too. Basing, the infection dynamics solely on the exponential growth factor only assumes that cases grow exponentially, which is theoretically and empirically justified. 
Additionally, the parameters in compartmental models may be harder to interpret, compared to, e.g., the exponential growth factor; see \Cref{subsec:usefulness_of_indicators}.

Before we present our results, we give a short overview of similar work, in particular those that leverage \glspl{ssm} to perform inference or short-term predictions for \gls{c19}.

In the context of \gls{c19}, variants of the Kalman filter have been employed to analyse the time-varying behavior of epidemiological parameters. Usually the models start from some theoretical, e.g. compartmental, model of how the epidemic spreads. After time-discretization and possibly linearization, one ends up with an \gls{glssm}, to which the Kalman filter or one of its variants may be applied. 
A prominent example is \citet{Arroyo-Marioli2021Tracking}, who derive a \gls{glssm} for a time-varying reproduction number from a SIR model.
\citep{Zhu2021Extended,Song2021Maximum} directly apply the \gls{ekf} to time-discretized compartmental models, fitting them either to simulated \citep{Zhu2021Extended} or real \citep{Song2021Maximum} data. Similarly, \citep{Engbert2020Sequential} use the \gls{enkf} to fit a stochastic compartmental model to German regional data, where the \gls{enkf} allows dealing with the non-linear and non-Gaussian properties on these small spatial scales.

One prominent approach involves modeling disease dynamics with growth factors. \citep{Arroyo-Marioli2021Tracking} develop a local level model for the log-growth factor based on a classical SIR model, which allows them to derive reproduction numbers. Their model is fully Gaussian and can be fitted using the Kalman smoother. Similarly, \citet{Ives2021Estimating} propose a related local level model for the log-growth factor, but use quasi-Poisson distributed observations and model the growth of deaths instead of the reported cases. Their model is fitted using the \gls{ekf} for US county-level data.

An alternative strategy derives state space models directly from epidemiological theory. \citep{Lal2021Application} and \citep{Keller2022Tracking} derive \glspl{ssm} from a time-discretized version of ODE-based compartmental models. In this framework, \citep{Lal2021Application} assume conditionally Gaussian observations, but the dependence between states and observations is non-linear, so the \gls{enkf} was used to fit the model. 
In contrast, \citep{Keller2022Tracking} adopt a fully Bayesian view with negative binomial observations for cases, hospitalizations, and deaths, placing priors on hyperparameters and deriving posterior distributions by Hamiltonian Monte-Carlo.

A third line of work leverages asymptotic theory for computational efficiency. \citep{ODea2022Semiparametric} for example implement this approach, exploiting an \gls{clt} for compartmental models, to obtain a Gaussian approximation to the states' dynamics. The model can then be fitted using the \gls{ekf}.

From this overview, we see that most existing \glspl{ssm} are derived from compartmental models. In contrast, the models we present in this section provide an alternative approach based on epidemiological indicators rather than compartmental structures. This offers practitioners simpler, more interpretable models with fewer assumptions about disease dynamics, providing greater flexibility when addressing specific research questions.

Unless noted otherwise, all computations are performed on an Apple Macbook Air M3 (2024) with 16GB RAM and are fitted in less than one hour of computation time. An exception is the larger model in \Cref{sec:regional_growth_factor_model}, see there for details on runtime.
\input{chapters/04_epidemiological_ssms/04_01_reporting_delays.tex}
\input{chapters/04_epidemiological_ssms/04_02_weekly_GF.tex}
\input{chapters/04_epidemiological_ssms/04_03_hospitalizations.tex}