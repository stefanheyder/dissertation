\chapter{Reproducibility and code}
\label{cha:reproducibility_and_code}
All code used in to create figures and tables in this thesis is written in Python and R \todo{cite} and available as open source software. Python is used for simulations, while R is used to create figures and tables of these results. 

The code is split into two software packages:
\begin{itemize}
    \item Importance Sampling for State Space Models (\texttt{isssm})\footnote{\url{https://stefanheyder.github.io/isssm}} is a Python package developed by the author. It implements frequentist inference for \acrshortpl{ssm} using the general methods described in this thesis, in particular the \acrshort{cem} and \acrshort{eis} for \acrshortpl{pgssm}. 
    \item The \acrshortpl{ssm} for Epidemiology \texttt{ssm4epi} package contains Python and R code particular to this thesis, i.e. the code needed to reproduce all results and figures in this thesis. 
\end{itemize}

The \texttt{ssm4epi} package is available as Jupyter Notebooks organized by chapters of this thesis. To reproduce the results of this thesis, follow the instructions in the associated documentation \todo{ref to doc}. Simulations use a fixed seed that is set at the beginning of each notebook to ensure reproducibility. 

The data produced by these Jupyter notebooks are available on zenodo \todo{put them there}, and can be reproduced by running the notebooks. Figures and tables in this thesis that depend on simulation results can be reproduced similarly, using Jupyter notebooks with an R kernel. Dependent R packages can be found in the \texttt{setup.R} file in this thesis' GitHub repository.

\chapter{Additional calculations}

\section*{\Cref{eq:variance-wxx}}
To show \Cref{eq:variance-wxx} we calculate the second moment of $w(X)X$,
\begin{align*}
    \mathbb E (w(X)X)^{2} &= \int w(x)^{2} x^{2} g(x) \d x \\
    &= \int \sigma^{2} \exp \left( - x^{2} \left( 1 - \frac{1}{\sigma^{2}} \right)\right)\, x^{2}\, \frac{1}{\sqrt{2\pi\sigma^{2}}} \exp \left( -\frac{x^{2}}{2\sigma^{2}} \right)  \d x \\
    &= \int \sigma x^{2} \frac{1}{\sqrt{2\pi}}\exp \left( - \frac{x^{2}}{2} \left( 2 - \frac{2}{\sigma^{2}} + \frac{1}{\sigma^{2}} \right) \right)\d x \\
    &= \int \sigma x^{2} \frac{1}{\sqrt{2\pi}}\exp \left( - \frac{x^{2}}{2} \frac{2\sigma^{2} - 1}{\sigma^{2}} \right)\d x \\
    &= \tau \sigma \int x^{2} \frac{1}{\sqrt{2\pi\tau^{2}}} \exp \left( - \frac{x^{2}}{2\tau^{2}}\right)\d x \\
    &= \tau^{3} \sigma = \frac{\sigma^{4}}{(2\sigma^{2} - 1)^{\frac{3}{2}}}
\end{align*}
where $\tau^{2} = \frac{\sigma^{2}}{2\sigma^{2} - 1}$.
